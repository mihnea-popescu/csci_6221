<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8" />
	<title>Elm Pok√©mon</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			font-family: sans-serif;
		}
	</style>
</head>

<body>
	<div id="elm"></div>
	<script src="main.js"></script>
	<script>
		const flags = {
			userAgent: navigator.userAgent,
			screenWidth: window.screen.width,
			screenHeight: window.screen.height,
			language: navigator.language,
			timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
		};

		const app = Elm.Main.init({
			node: document.getElementById("elm"),
			flags,
		});

		const STORAGE_KEY = "pokemon-seed";

		// Mihnea's original localStorage ports
		app.ports.loadSeed.subscribe(() => {
			const stored = localStorage.getItem(STORAGE_KEY);
			const seed = stored ? parseInt(stored) : 0;
			app.ports.onSeedLoaded.send(seed);
		});

		app.ports.saveSeed.subscribe((seed) => {
			localStorage.setItem(STORAGE_KEY, String(seed));
		});

		// Jaimin's sound effect ports with better audio files
		
		// Sound for when a new Pokemon appears (whoosh/appear sound)
		app.ports.playNewPokemonSound.subscribe(() => {
			console.log('Playing new Pokemon sound...');
			const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3');
			audio.volume = 0.4;
			audio.play()
				.then(() => console.log('New Pokemon sound played successfully'))
				.catch(err => console.log('Audio play failed:', err));
		});

		// Sound for when user guesses correctly (success sound)
		app.ports.playCorrectGuessSound.subscribe(() => {
			console.log('Playing correct guess sound...');
			const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2018/2018-preview.mp3');
			audio.volume = 0.5;
			audio.play()
				.then(() => console.log('Correct guess sound played successfully'))
				.catch(err => console.log('Audio play failed:', err));
		});

		// Sound for when max attempts reached (failure sound)
		app.ports.playFailureSound.subscribe(() => {
			console.log('Playing failure sound...');
			const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2955/2955-preview.mp3');
			audio.volume = 0.4;
			audio.play()
				.then(() => console.log('Failure sound played successfully'))
				.catch(err => console.log('Audio play failed:', err));
		});
	</script>
</body>

</html>
